<?php

/**
 * DIAGN√ìSTICO COMPLETO - POR QUE O EMAIL N√ÉO CHEGA NO REGISTRO?
 * 
 * Este script simula exatamente o que acontece no RegisterWizard
 */

require __DIR__.'/vendor/autoload.php';

$app = require_once __DIR__.'/bootstrap/app.php';
$app->make('Illuminate\Contracts\Console\Kernel')->bootstrap();

echo "\n";
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
echo "  DIAGN√ìSTICO COMPLETO - EMAIL DE REGISTRO\n";
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";

$testEmail = 'tiofox2019@gmail.com';

// PASSO 1: Verificar SMTP Settings no banco
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "1Ô∏è‚É£  VERIFICANDO CONFIGURA√á√ïES SMTP NO BANCO\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";

$smtpSettings = \App\Models\SmtpSetting::all();

if ($smtpSettings->isEmpty()) {
    echo "‚ùå PROBLEMA 1: NENHUMA CONFIGURA√á√ÉO SMTP NO BANCO!\n\n";
    echo "üìç SOLU√á√ÉO:\n";
    echo "   1. Acesse: http://soserp.test/superadmin/smtp-settings\n";
    echo "   2. Clique em 'Nova Configura√ß√£o'\n";
    echo "   3. Preencha:\n";
    echo "      - Host: smtp.gmail.com\n";
    echo "      - Port: 587\n";
    echo "      - Username: tiofox2019@gmail.com\n";
    echo "      - Password: [Senha de APP do Gmail]\n";
    echo "      - Encryption: TLS\n";
    echo "      - From Email: tiofox2019@gmail.com\n";
    echo "      - From Name: SOSERP\n";
    echo "      ‚úì Marcar como Padr√£o\n";
    echo "      ‚úì Marcar como Ativo\n\n";
    echo "   OU execute via Tinker:\n\n";
    echo "   php artisan tinker\n\n";
    echo "   \\App\\Models\\SmtpSetting::create([\n";
    echo "       'host' => 'smtp.gmail.com',\n";
    echo "       'port' => 587,\n";
    echo "       'username' => 'tiofox2019@gmail.com',\n";
    echo "       'password' => 'sua-senha-de-app-aqui',\n";
    echo "       'encryption' => 'tls',\n";
    echo "       'from_email' => 'tiofox2019@gmail.com',\n";
    echo "       'from_name' => 'SOSERP',\n";
    echo "       'is_default' => true,\n";
    echo "       'is_active' => true,\n";
    echo "   ]);\n\n";
    
    echo "PARE AQUI! Configure o SMTP primeiro.\n\n";
    exit(1);
}

echo "‚úÖ Configura√ß√µes SMTP encontradas: " . $smtpSettings->count() . "\n\n";

// Mostrar cada configura√ß√£o
foreach ($smtpSettings as $smtp) {
    $status = $smtp->is_active ? 'üü¢ ATIVA' : 'üî¥ INATIVA';
    $default = $smtp->is_default ? '‚≠ê PADR√ÉO' : '';
    
    echo "üìß Configura√ß√£o #{$smtp->id} {$status} {$default}\n";
    echo "   Host: {$smtp->host}:{$smtp->port}\n";
    echo "   Encryption: " . strtoupper($smtp->encryption) . "\n";
    echo "   Username: {$smtp->username}\n";
    echo "   From: {$smtp->from_email} ({$smtp->from_name})\n";
    echo "   Tenant: " . ($smtp->tenant_id ? "#{$smtp->tenant_id}" : "Global") . "\n";
    
    // Tentar descriptografar senha
    try {
        $password = $smtp->password; // Usa o accessor que descriptografa
        echo "   Senha: " . (strlen($password) > 0 ? str_repeat('*', strlen($password)) . " (" . strlen($password) . " caracteres)" : "‚ùå VAZIA!") . "\n";
    } catch (\Exception $e) {
        echo "   Senha: ‚ùå ERRO AO DESCRIPTOGRAFAR!\n";
    }
    
    if ($smtp->last_tested_at) {
        echo "   √öltimo teste: {$smtp->last_tested_at->format('d/m/Y H:i')}\n";
    } else {
        echo "   √öltimo teste: ‚ö†Ô∏è  Nunca testado\n";
    }
    echo "\n";
}

// Verificar se tem padr√£o ativa
$defaultSmtp = \App\Models\SmtpSetting::default()->active()->first();

if (!$defaultSmtp) {
    echo "‚ùå PROBLEMA 2: NENHUMA CONFIGURA√á√ÉO MARCADA COMO PADR√ÉO E ATIVA!\n\n";
    echo "üìç SOLU√á√ÉO:\n";
    echo "   1. Acesse: http://soserp.test/superadmin/smtp-settings\n";
    echo "   2. Edite uma configura√ß√£o\n";
    echo "   3. Marque ‚úì Padr√£o\n";
    echo "   4. Marque ‚úì Ativo\n";
    echo "   5. Salve\n\n";
    
    // Tentar pegar a primeira ativa
    $defaultSmtp = \App\Models\SmtpSetting::active()->first();
    
    if (!$defaultSmtp) {
        echo "‚ùå PROBLEMA 3: NENHUMA CONFIGURA√á√ÉO ATIVA!\n";
        echo "   Ative pelo menos uma configura√ß√£o.\n\n";
        exit(1);
    }
    
    echo "‚ö†Ô∏è  Usando a primeira configura√ß√£o ativa como fallback.\n\n";
}

echo "‚úÖ Configura√ß√£o SMTP padr√£o: {$defaultSmtp->host}:{$defaultSmtp->port}\n\n";

// PASSO 2: Verificar Template
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "2Ô∏è‚É£  VERIFICANDO TEMPLATE 'welcome'\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";

$template = \App\Models\EmailTemplate::where('slug', 'welcome')->first();

if (!$template) {
    echo "‚ùå PROBLEMA 4: TEMPLATE 'welcome' N√ÉO EXISTE!\n\n";
    echo "üìç SOLU√á√ÉO:\n";
    echo "   php artisan db:seed --class=EmailTemplateSeeder\n\n";
    exit(1);
}

echo "‚úÖ Template encontrado: {$template->name}\n";
echo "   Assunto: {$template->subject}\n";
echo "   Ativo: " . ($template->is_active ? 'Sim' : 'N√£o') . "\n\n";

if (!$template->is_active) {
    echo "‚ùå PROBLEMA 5: TEMPLATE EST√Å INATIVO!\n\n";
    echo "üìç SOLU√á√ÉO:\n";
    echo "   Ativando template...\n";
    $template->update(['is_active' => true]);
    echo "   ‚úÖ Template ativado!\n\n";
}

// PASSO 3: Simular exatamente o envio do RegisterWizard
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "3Ô∏è‚É£  SIMULANDO ENVIO EXATO DO REGISTER WIZARD\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";

// Criar dados de teste exatamente como o RegisterWizard
$emailData = [
    'user_name' => 'Teste TioFox',
    'tenant_name' => 'Empresa Teste',
    'app_name' => config('app.name', 'SOS ERP'),
    'login_url' => route('login'),
];

echo "Dados do email (exatamente como RegisterWizard):\n";
foreach ($emailData as $key => $value) {
    echo "  - {$key}: {$value}\n";
}
echo "\n";

// Simular o envio EXATAMENTE como RegisterWizard faz
echo "Tentando enviar email exatamente como RegisterWizard...\n\n";

try {
    \Log::info('===== TESTE: INICIANDO ENVIO DE EMAIL =====', [
        'user_email' => $testEmail,
        'template' => 'welcome',
    ]);
    
    // EXATAMENTE como na linha 622-623 do RegisterWizard.php
    \Illuminate\Support\Facades\Mail::to($testEmail)
        ->send(new \App\Mail\TemplateMail('welcome', $emailData, null));
    
    \Log::info('===== TESTE: EMAIL ENVIADO COM SUCESSO! =====');
    
    echo "‚úÖ EMAIL ENVIADO COM SUCESSO!\n\n";
    echo "üìß Servidor usado: {$defaultSmtp->host}:{$defaultSmtp->port}\n";
    echo "üìß De: {$defaultSmtp->from_email}\n";
    echo "üìß Para: {$testEmail}\n\n";
    echo "üîç VERIFIQUE:\n";
    echo "   1. Caixa de entrada de {$testEmail}\n";
    echo "   2. Pasta de SPAM\n";
    echo "   3. Pasta de Promo√ß√µes (Gmail)\n\n";
    
} catch (\Exception $e) {
    echo "‚ùå ERRO AO ENVIAR EMAIL!\n\n";
    echo "Mensagem: {$e->getMessage()}\n";
    echo "Arquivo: {$e->getFile()}\n";
    echo "Linha: {$e->getLine()}\n\n";
    
    echo "Stack Trace:\n";
    echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n";
    echo $e->getTraceAsString();
    echo "\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n";
    
    \Log::error('===== TESTE: ERRO AO ENVIAR EMAIL =====', [
        'error_message' => $e->getMessage(),
        'error_file' => $e->getFile(),
        'error_line' => $e->getLine(),
    ]);
    
    // Diagn√≥stico espec√≠fico do erro
    echo "üîç DIAGN√ìSTICO DO ERRO:\n\n";
    
    $errorMsg = strtolower($e->getMessage());
    
    if (strpos($errorMsg, 'authentication') !== false || strpos($errorMsg, 'username') !== false || strpos($errorMsg, 'password') !== false) {
        echo "‚ùå PROBLEMA: ERRO DE AUTENTICA√á√ÉO SMTP\n\n";
        echo "üìç POSS√çVEIS CAUSAS:\n";
        echo "   1. Senha incorreta (deve ser Senha de APP do Gmail, n√£o a senha normal!)\n";
        echo "   2. Username incorreto\n";
        echo "   3. Conta Gmail sem autentica√ß√£o de 2 fatores ativada\n\n";
        echo "üìç SOLU√á√ÉO:\n";
        echo "   1. Acesse: https://myaccount.google.com/apppasswords\n";
        echo "   2. Gere uma senha de app para 'SOSERP'\n";
        echo "   3. Copie a senha (remova espa√ßos)\n";
        echo "   4. Acesse: http://soserp.test/superadmin/smtp-settings\n";
        echo "   5. Edite a configura√ß√£o e cole a nova senha\n";
        echo "   6. Teste a conex√£o\n\n";
        
    } elseif (strpos($errorMsg, 'connection') !== false || strpos($errorMsg, 'refused') !== false) {
        echo "‚ùå PROBLEMA: N√ÉO CONSEGUE CONECTAR AO SERVIDOR SMTP\n\n";
        echo "üìç POSS√çVEIS CAUSAS:\n";
        echo "   1. Porta bloqueada pelo firewall\n";
        echo "   2. Host incorreto\n";
        echo "   3. Servidor SMTP fora do ar\n\n";
        echo "üìç SOLU√á√ÉO:\n";
        echo "   1. Testar conex√£o: Test-NetConnection smtp.gmail.com -Port 587\n";
        echo "   2. Verificar firewall do Windows\n";
        echo "   3. Tentar porta 465 com SSL ao inv√©s de 587 TLS\n\n";
        
    } elseif (strpos($errorMsg, 'template') !== false) {
        echo "‚ùå PROBLEMA: ERRO NO TEMPLATE\n\n";
        echo "   Execute: php artisan db:seed --class=EmailTemplateSeeder\n\n";
        
    } else {
        echo "‚ùå PROBLEMA: ERRO DESCONHECIDO\n\n";
        echo "   Verifique os logs: storage/logs/laravel.log\n\n";
    }
    
    exit(1);
}

// PASSO 4: Verificar logs
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "4Ô∏è‚É£  VERIFICANDO LOGS DO SISTEMA\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";

$logFile = storage_path('logs/laravel.log');

if (file_exists($logFile)) {
    $lines = file($logFile);
    $emailLines = array_filter($lines, function($line) {
        return stripos($line, 'email') !== false || 
               stripos($line, 'mail') !== false || 
               stripos($line, 'smtp') !== false;
    });
    
    $lastEmailLines = array_slice($emailLines, -10);
    
    if (!empty($lastEmailLines)) {
        echo "√öltimas 10 linhas relacionadas a email:\n";
        echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n";
        foreach ($lastEmailLines as $line) {
            echo $line;
        }
        echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n";
    } else {
        echo "‚ö†Ô∏è  Nenhuma linha de log relacionada a email encontrada.\n\n";
    }
} else {
    echo "‚ö†Ô∏è  Arquivo de log n√£o encontrado.\n\n";
}

// RESUMO FINAL
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
echo "  ‚úÖ DIAGN√ìSTICO CONCLU√çDO\n";
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";

echo "üìã CHECKLIST:\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "‚úÖ Configura√ß√£o SMTP no banco: SIM\n";
echo "‚úÖ Configura√ß√£o marcada como padr√£o: SIM\n";
echo "‚úÖ Configura√ß√£o ativa: SIM\n";
echo "‚úÖ Template 'welcome' existe: SIM\n";
echo "‚úÖ Template 'welcome' ativo: SIM\n";
echo "‚úÖ Email enviado com sucesso: SIM\n\n";

echo "üéØ PR√ìXIMO PASSO:\n";
echo "   1. Verifique o email em: {$testEmail}\n";
echo "   2. Verifique a pasta de SPAM\n";
echo "   3. Se n√£o receber, o problema √© no Gmail/SMTP\n";
echo "   4. Teste fazer um registro real em: http://soserp.test/register\n\n";

echo "üìÅ Logs dispon√≠veis em:\n";
echo "   {$logFile}\n\n";

echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
